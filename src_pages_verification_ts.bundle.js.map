{"version":3,"file":"src_pages_verification_ts.bundle.js","mappings":";;;;;;;;;;;;;;;;;;;;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACkD;AACmD;AACrC;AACI;AACvB;AACM;AACF;AACjD;AACA;AACA;AACA;AACA,wCAAwC,4EAAuB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mDAAgB;AACxB,wBAAwB;AACxB;AACA;AACA,QAAQ,2DAAQ;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6DAAU;AAClC;AACA,4BAA4B,4EAAqB;AACjD;AACA;AACA;AACA,cAAc,8DAAW;AACzB,QAAQ,mDAAgB;AACxB,QAAQ,6CAAU,CAAC,qEAAgB;AACnC,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,2DAAQ;AACpB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sDAAsD;AAClF;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACe;AACf;AACA,kCAAkC,oEAAe,GAAG,0EAAqB;AACzE;AACA;AACA;AACA,KAAK;AACL","sources":["webpack://admin/./src/pages/verification.ts"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport navigateTo, { setLoadingStatus } from \"..\";\nimport { FOLDER_TEMPLATE, PATH_ADDRESS_MAP, TEMPLATE_VERIFICATION } from \"../constants/webConstants\";\nimport { requestVerifyCodeById } from \"../utilities/ApiHandler\";\nimport { onButtonVisibilityClick } from \"../utilities/EventHandler\";\nimport MyLogger from \"../utilities/MyLogger\";\nimport MyUtilities from \"../utilities/MyUtilities\";\nimport SecureAuth from \"../utilities/SecureAuth\";\n// Global action identifier for verification type\nvar gAction = -1;\n// Event handlers\nfunction onLoad() {\n    $(\".button-visibility\").on('click', onButtonVisibilityClick);\n    $(\"#form-verify\").on('submit', onFormSubmit);\n    $(\"#button-resend-email\").on('click', onButtonResendEmailClick);\n    setupVerificationInputs();\n}\nfunction onFormSubmit(e) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (e) {\n            e.preventDefault();\n        }\n        setLoadingStatus(true);\n        var vObject = { code: '' };\n        // B1: Collect form data\n        collectData(vObject);\n        MyLogger.log(\"Verification\");\n        // B2: Validate form data\n        var vResultValidate = validateData(vObject);\n        if (!vResultValidate) {\n            return;\n        }\n        // B3: Call API\n        var vUserData = SecureAuth.getUserInfo();\n        // Verify code with API\n        var vResult = yield requestVerifyCodeById(vUserData === null || vUserData === void 0 ? void 0 : vUserData.id, vObject.code, gAction);\n        if (vResult == null) {\n            return;\n        }\n        yield MyUtilities.checkExistingUser();\n        setLoadingStatus(false);\n        navigateTo(PATH_ADDRESS_MAP);\n    });\n}\nfunction onButtonResendEmailClick() {\n    return __awaiter(this, void 0, void 0, function* () {\n    });\n}\n// Data collection and validation\nfunction collectData(paramObject) {\n    var vNum1 = $(\"#input-verify-code1\").val().toString().trim();\n    var vNum2 = $(\"#input-verify-code2\").val().toString().trim();\n    var vNum3 = $(\"#input-verify-code3\").val().toString().trim();\n    var vNum4 = $(\"#input-verify-code4\").val().toString().trim();\n    var vNum5 = $(\"#input-verify-code5\").val().toString().trim();\n    paramObject['code'] = vNum1 + vNum2 + vNum3 + vNum4 + vNum5;\n    // Set action based on existing session\n    gAction = 0;\n}\nfunction validateData(paramObject) {\n    let vResult = true;\n    if (paramObject['code'].length == 0) {\n        $(\"#input-verification\").addClass('border-danger')\n            .attr('title', 'Code is incorrect');\n        vResult = false;\n    }\n    return vResult;\n}\nfunction setupVerificationInputs() {\n    const vInputs = $('.input-code-verify');\n    vInputs.each(function (index) {\n        const vInputCurrent = $(this);\n        // Handle input event\n        vInputCurrent.on('input', function (e) {\n            const value = $(this).val();\n            // Only allow alphanumeric characters\n            const sanitized = value.replace(/[^a-zA-Z0-9]/g, '');\n            $(this).val(sanitized.toUpperCase());\n            // Move to next input if filled\n            if (sanitized.length > 1) {\n                $(this).val(value.slice(value.length - 1));\n            }\n            if (sanitized.length != 1) {\n                return;\n            }\n            if (index < vInputs.length - 1) {\n                vInputs.eq(index + 1).focus();\n                return;\n            }\n            MyLogger.log(\"Last input\");\n            onFormSubmit();\n        });\n        // Handle keydown for backspace\n        vInputCurrent.on('keydown', function (e) {\n            // If backspace and input is empty, move to previous input\n            if (e.key === 'Backspace' && $(this).val() === '' && index > 0) {\n                vInputs.eq(index - 1).focus();\n            }\n        });\n        // Handle paste event\n        vInputCurrent.on('paste', function (e) {\n            var _a;\n            e.preventDefault();\n            // Get pasted text\n            const pastedText = ((_a = e.originalEvent.clipboardData) === null || _a === void 0 ? void 0 : _a.getData('text')) || '';\n            const sanitized = pastedText.replace(/[^a-zA-Z0-9]/g, '').toUpperCase();\n            // Fill inputs with pasted characters\n            for (let i = 0; i < sanitized.length && (index + i) < vInputs.length; i++) {\n                vInputs.eq(index + i).val(sanitized[i]);\n            }\n            // Focus next empty input or last input\n            const nextIndex = Math.min(index + sanitized.length, vInputs.length - 1);\n            vInputs.eq(nextIndex).focus();\n        });\n    });\n    // Focus first input on load\n    vInputs.eq(0).focus();\n}\n// Main page initialization\nexport default function verificationPage() {\n    return __awaiter(this, void 0, void 0, function* () {\n        const vHtml = yield fetch(FOLDER_TEMPLATE + TEMPLATE_VERIFICATION)\n            .then(res => res.text());\n        $(\"#main-container\").append(vHtml);\n        onLoad();\n    });\n}\n"],"names":[],"sourceRoot":""}