{"version":3,"file":"src_pages_profile_ts.bundle.js","mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AAC6C;AACiB;AAC3B;AACQ;AACoB;AAClB;AACI;AACE;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,WAAW;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,eAAe;AAC5B,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA,qBAAqB,6DAAU;AAC/B;AACA,YAAY,6CAAU;AACtB;AACA;AACA;AACA,mCAAmC,8DAAW;AAC9C;AACA,oCAAoC,oEAAiB;AACrD,yBAAyB,sEAAiB,MAAM,wDAAS;AACzD;AACA;AACA,YAAY,8DAAW;AACvB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,YAAY,2DAAQ;AACpB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,gBAAgB,8DAAW,oBAAoB,iDAAQ,CAAC,8CAAW;AACnE;AACA;AACA,YAAY,2DAAQ;AACpB,YAAY,2DAAQ;AACpB,4BAA4B,6DAAU;AACtC,2BAA2B,oEAAiB;AAC5C,yBAAyB,sEAAiB,MAAM,wDAAS;AACzD,sCAAsC,qBAAqB;AAC3D,8BAA8B,6DAAU;AACxC,YAAY,2DAAQ;AACpB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,eAAe;AAC5B,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,iBAAiB;AACpF;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,2DAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,eAAe;AAC5B,YAAY,OAAO;AACnB;AACe;AACf;AACA;AACA;AACA;AACA,KAAK;AACL","sources":["webpack://admin/./src/pages/profile.ts"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport navigateTo, { getLanguage } from \"..\";\nimport { PATH_API_EMPLOYEE } from \"../constants/APIConstants\";\nimport language from \"../language\";\nimport PageModel from \"../model/PageModel\";\nimport APIRequestBuilder from \"../utilities/APIRequestBuilder\";\nimport MyLogger from \"../utilities/MyLogger\";\nimport SecureAuth from \"../utilities/SecureAuth\";\nimport MyUtilities from \"../utilities/MyUtilities\";\n/**\n * Profile Page - User Account Management and Settings\n *\n * This module provides a comprehensive profile management interface for\n * employees/admins in the real estate system. It handles user information\n * display, profile photo uploads, and account statistics.\n *\n * Features:\n * - Profile photo upload (from device or URL)\n * - User information display and editing\n * - Account statistics (posts, views)\n * - Session-based data caching\n * - Real-time profile updates\n */\n// REGION 1: Global variables and configuration\n/**\n * Global variable to store the selected user profile image file\n *\n * Holds the File object for the user's profile photo during the upload process.\n * Can be populated from either:\n * - Direct file upload from user's device\n * - Converted File object from image URL\n *\n * @type {File|null} The image file to be uploaded, or null if no image selected\n */\nvar gImageUser = null;\n// REGION 2: Page initialization\n/**\n * Initialize and load profile page data\n *\n * Orchestrates the complete profile page setup including:\n * - User authentication verification\n * - Profile data loading from session or API\n * - Event handler binding for all interactive elements\n * - Photo upload modal configuration\n * - Profile statistics display\n *\n * @returns {Promise<void>} Promise that resolves when page is fully initialized\n * @throws {Error} If user authentication fails or API request errors occur\n */\nfunction onLoad() {\n    return __awaiter(this, void 0, void 0, function* () {\n        // Verify user authentication\n        var vToken = SecureAuth.getUserInfo();\n        if (vToken == null) {\n            navigateTo('/');\n            return;\n        }\n        // Load user data from session or API\n        var vUserData = JSON.parse(MyUtilities.getSessionData('user'));\n        if (vUserData == null) {\n            var vResult = yield new APIRequestBuilder()\n                .setPath(PATH_API_EMPLOYEE, new PageModel())\n                .getById(vToken.id);\n            vUserData = vResult.data;\n            MyUtilities.setSessionData('user', JSON.stringify(vUserData));\n        }\n        updateUserField(vUserData);\n        // Photo upload modal trigger\n        $(\"#button-upload\").on('click', () => {\n            $(\"#modal-upload\").modal('show');\n        });\n        // Handle file upload from device\n        $(\"#input-photo-upload\").on('change', (event) => {\n            var vFile = event.target.files[0];\n            if (vFile != null) {\n                var vReader = new FileReader();\n                vReader.onload = (paramReaderEvent) => {\n                    $(\"#img-photo-upload\").attr('src', paramReaderEvent.target.result.toString());\n                    gImageUser = vFile;\n                };\n                vReader.readAsDataURL(vFile);\n            }\n        });\n        // Handle image URL input\n        $(\"#input-photo-upload-text\").on('change', (event) => __awaiter(this, void 0, void 0, function* () {\n            MyLogger.log(event.target.value);\n            var vImageLink = event.target.value;\n            var vImageSplit = vImageLink.split('.');\n            $(\"#img-photo-upload\").attr('src', event.target.value);\n            gImageUser = yield convertImageUrlToFile(event.target.value);\n        }));\n        // Confirm photo upload\n        $(\"#button-upload-confirm\").on('click', () => __awaiter(this, void 0, void 0, function* () {\n            if (gImageUser == null) {\n                MyUtilities.showToast('error', language[getLanguage()].err_image_none);\n                return;\n            }\n            MyLogger.log('------ 1');\n            MyLogger.log('------ 2');\n            var vUserData = SecureAuth.getUserInfo();\n            var vApi = new APIRequestBuilder()\n                .setPath(PATH_API_EMPLOYEE, new PageModel());\n            yield vApi.updateSingle({ 'photo': gImageUser }, vUserData.id);\n            var vUser = yield SecureAuth.getCurrentUser();\n            MyLogger.log(\"---- fetch user data:\", JSON.stringify(vUser));\n            $(\".user-info img\").attr('src', vUser.photo);\n            $(\"#modal-upload\").modal('hide');\n            $(\"#img-user-photo\").attr('src', vUserData.photo);\n            $(\"#img-profile-pic\").attr('src', vUserData.photo);\n        }));\n        // Account tab navigation\n        $(\"#button-account\").on('click', function () {\n            $(this).siblings('div').css('left', '0%').css('opacity', 1);\n            $(this).addClass('text-white');\n            $('#button-estate').removeClass('text-white');\n        });\n        $(\".button-edit-input\").on('click', function () {\n            var vDivInput = $(this).parent().siblings('div');\n            var vInput = vDivInput.children('input');\n            var vButton = vDivInput.children('button');\n            console.log(\"Pressed:\", vInput);\n            vInput.removeAttr('disabled');\n        });\n    });\n}\n// REGION 3: Utility functions\n/**\n * Convert an image URL to a File object for upload\n *\n * Fetches an image from the provided URL, converts it to a Blob,\n * and creates a File object suitable for form uploads. Automatically\n * detects and preserves the image format from the URL extension.\n *\n * @param {string} paramImageUrl - The complete URL of the image to convert\n * @returns {Promise<File>} Promise resolving to a File object with the image data\n * @throws {Error} If the image URL is invalid or fetch fails\n *\n * @example\n * const imageFile = await convertImageUrlToFile('https://example.com/photo.jpg');\n * // Returns File object named 'selectedImage.jpg'\n */\nfunction convertImageUrlToFile(paramImageUrl) {\n    return __awaiter(this, void 0, void 0, function* () {\n        var vImageSplit = paramImageUrl.split('.');\n        const format = vImageSplit[vImageSplit.length - 1];\n        const response = yield fetch(paramImageUrl);\n        const blob = yield response.blob();\n        const file = new File([blob], 'selectedImage.' + format, { type: blob.type });\n        return file;\n    });\n}\n/**\n * Update user interface fields with profile data\n *\n * Populates all profile page form fields and statistics with the provided\n * user data. Updates both display elements and input fields including:\n * - Profile photos (multiple instances)\n * - Personal information (name, email, phone)\n * - Account statistics (posts count, views)\n * - Employment information (hire date)\n *\n * @param {EmployeeModel} paramData - The employee/user data object containing all profile information\n * @returns {void}\n *\n * @example\n * updateUserField(userData);\n * // Populates all profile fields with userData properties\n */\nfunction updateUserField(paramData) {\n    MyLogger.log(paramData);\n    $(\"#img-profile-pic\").attr('src', paramData.photo);\n    $(\"#img-user-photo\").attr('src', paramData.photo);\n    $(\"#input-email\").val(paramData.email);\n    $(\"#input-name-first\").val(paramData.firstName);\n    $(\"#input-name-last\").val(paramData.lastName);\n    $(\"#input-phone\").val(paramData.homePhone);\n    var vDateJoin = new Date(paramData['hireDate']);\n    $(\"#input-date-join\").val(vDateJoin.toLocaleString());\n    $(\"#span-post-total\").text(paramData['numRealEstates']);\n    $(\"#span-post-today\").text(paramData['numRealEstatesToday']);\n    $(\"#span-view-total\").text(paramData['viewRealEstates']);\n}\n// REGION 4: Page export\n/**\n * Main profile page initialization function\n *\n * Loads the profile page template and initializes all profile functionality.\n * This is the entry point called by the routing system when navigating to\n * the profile page.\n *\n * Workflow:\n * 1. Fetches profile.html template\n * 2. Injects template into main container\n * 3. Initializes page with onLoad()\n *\n * @returns {Promise<void>} Promise that resolves when profile page is fully loaded and configured\n * @throws {Error} If template fetch fails or initialization errors occur\n */\nexport default function UserPage() {\n    return __awaiter(this, void 0, void 0, function* () {\n        var vHtml = yield fetch('/templates/profile.html').then(res => res.text());\n        $(\"#main-container\").html(vHtml);\n        yield onLoad();\n    });\n}\n"],"names":[],"sourceRoot":""}